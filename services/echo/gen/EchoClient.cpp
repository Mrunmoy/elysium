// Auto-generated by ipcgen (embedded) -- do not edit.
#include "EchoClient.h"

namespace kernel
{
namespace ipc
{

std::int32_t EchoClient::Ping(uint32_t value, uint32_t *result)
{
    static_assert(sizeof(uint32_t) <= kernel::kMaxPayloadSize,
        "Ping: [in] params exceed payload limit");
    static_assert(sizeof(uint32_t) <= kernel::kMaxPayloadSize,
        "Ping: [out] params exceed payload limit");
    kernel::Message request;
    std::memset(&request, 0, sizeof(request));
    request.type = static_cast<std::uint8_t>(kernel::MessageType::Request);
    request.serviceId = kServiceId;
    request.methodId = kPing;
    std::memcpy(request.payload, &value, sizeof(uint32_t));
    request.payloadSize = static_cast<std::uint16_t>(sizeof(uint32_t));

    kernel::Message reply;
    std::int32_t rc = kernel::messageSend(m_serverTid, request, &reply);
    if (rc != kernel::kIpcOk)
    {
        return rc;
    }

    if (result != nullptr)
        std::memcpy(result, reply.payload, sizeof(uint32_t));

    return reply.status;
}

std::int32_t EchoClient::Add(uint32_t a, uint32_t b, uint32_t *sum)
{
    static_assert(sizeof(uint32_t) + sizeof(uint32_t) <= kernel::kMaxPayloadSize,
        "Add: [in] params exceed payload limit");
    static_assert(sizeof(uint32_t) <= kernel::kMaxPayloadSize,
        "Add: [out] params exceed payload limit");
    kernel::Message request;
    std::memset(&request, 0, sizeof(request));
    request.type = static_cast<std::uint8_t>(kernel::MessageType::Request);
    request.serviceId = kServiceId;
    request.methodId = kAdd;
    std::memcpy(request.payload, &a, sizeof(uint32_t));
    std::memcpy(request.payload + sizeof(uint32_t), &b, sizeof(uint32_t));
    request.payloadSize = static_cast<std::uint16_t>(sizeof(uint32_t) + sizeof(uint32_t));

    kernel::Message reply;
    std::int32_t rc = kernel::messageSend(m_serverTid, request, &reply);
    if (rc != kernel::kIpcOk)
    {
        return rc;
    }

    if (sum != nullptr)
        std::memcpy(sum, reply.payload, sizeof(uint32_t));

    return reply.status;
}

std::int32_t EchoClient::GetCount(uint32_t *count)
{
    static_assert(sizeof(uint32_t) <= kernel::kMaxPayloadSize,
        "GetCount: [out] params exceed payload limit");
    kernel::Message request;
    std::memset(&request, 0, sizeof(request));
    request.type = static_cast<std::uint8_t>(kernel::MessageType::Request);
    request.serviceId = kServiceId;
    request.methodId = kGetCount;
    request.payloadSize = 0;

    kernel::Message reply;
    std::int32_t rc = kernel::messageSend(m_serverTid, request, &reply);
    if (rc != kernel::kIpcOk)
    {
        return rc;
    }

    if (count != nullptr)
        std::memcpy(count, reply.payload, sizeof(uint32_t));

    return reply.status;
}

}  // namespace ipc
}  // namespace kernel
